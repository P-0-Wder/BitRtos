ARM GAS  /var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"delay.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.delay_init,"ax",%progbits
  18              		.align	1
  19              		.global	delay_init
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	delay_init:
  27              	.LFB123:
  28              		.file 1 "SYS/delay/delay.c"
   1:SYS/delay/delay.c **** #include "delay.h"
   2:SYS/delay/delay.c **** #include "runtime.h"
   3:SYS/delay/delay.c **** #include "stm32f4xx_it.h"
   4:SYS/delay/delay.c **** #include "misc.h"
   5:SYS/delay/delay.c **** 
   6:SYS/delay/delay.c **** #define configTICK_RATE_HZ 167
   7:SYS/delay/delay.c **** 
   8:SYS/delay/delay.c **** static volatile uint32_t us_time;
   9:SYS/delay/delay.c **** 
  10:SYS/delay/delay.c **** static u8 fac_us = 0;
  11:SYS/delay/delay.c **** static u16 fac_ms = 0;
  12:SYS/delay/delay.c **** 
  13:SYS/delay/delay.c **** void delay_init(void)
  14:SYS/delay/delay.c **** {
  29              		.loc 1 14 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33 0000 08B5     		push	{r3, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 8
  36              		.cfi_offset 3, -8
  37              		.cfi_offset 14, -4
  15:SYS/delay/delay.c **** 	u32 reload;
  38              		.loc 1 15 2 view .LVU1
  16:SYS/delay/delay.c **** 	SysTick_CLKSourceConfig(SysTick_CLKSource_HCLK);
  39              		.loc 1 16 2 view .LVU2
  40 0002 0420     		movs	r0, #4
  41 0004 FFF7FEFF 		bl	SysTick_CLKSourceConfig
  42              	.LVL0:
ARM GAS  /var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s 			page 2


  17:SYS/delay/delay.c **** 	fac_us = configTICK_RATE_HZ + 1;
  43              		.loc 1 17 2 view .LVU3
  44              		.loc 1 17 9 is_stmt 0 view .LVU4
  45 0008 094B     		ldr	r3, .L3
  46 000a A822     		movs	r2, #168
  47 000c 1A70     		strb	r2, [r3]
  18:SYS/delay/delay.c **** 	reload = configTICK_RATE_HZ + 1;
  48              		.loc 1 18 2 is_stmt 1 view .LVU5
  49              	.LVL1:
  19:SYS/delay/delay.c **** 	reload *= 1000000 / configTICK_RATE_HZ;
  50              		.loc 1 19 2 view .LVU6
  20:SYS/delay/delay.c **** 	fac_ms = 1000 / configTICK_RATE_HZ;
  51              		.loc 1 20 2 view .LVU7
  52              		.loc 1 20 9 is_stmt 0 view .LVU8
  53 000e 094B     		ldr	r3, .L3+4
  54 0010 0522     		movs	r2, #5
  55 0012 1A80     		strh	r2, [r3]	@ movhi
  21:SYS/delay/delay.c **** 	SysTick->CTRL |= SysTick_CTRL_TICKINT_Msk;
  56              		.loc 1 21 2 is_stmt 1 view .LVU9
  57              		.loc 1 21 16 is_stmt 0 view .LVU10
  58 0014 4FF0E023 		mov	r3, #-536813568
  59 0018 1A69     		ldr	r2, [r3, #16]
  60 001a 42F00202 		orr	r2, r2, #2
  61 001e 1A61     		str	r2, [r3, #16]
  22:SYS/delay/delay.c **** 	SysTick->LOAD = reload;
  62              		.loc 1 22 2 is_stmt 1 view .LVU11
  63              		.loc 1 22 16 is_stmt 0 view .LVU12
  64 0020 054A     		ldr	r2, .L3+8
  65 0022 5A61     		str	r2, [r3, #20]
  23:SYS/delay/delay.c **** 	SysTick->CTRL |= SysTick_CTRL_ENABLE_Msk;
  66              		.loc 1 23 2 is_stmt 1 view .LVU13
  67              		.loc 1 23 16 is_stmt 0 view .LVU14
  68 0024 1A69     		ldr	r2, [r3, #16]
  69 0026 42F00102 		orr	r2, r2, #1
  70 002a 1A61     		str	r2, [r3, #16]
  24:SYS/delay/delay.c **** }
  71              		.loc 1 24 1 view .LVU15
  72 002c 08BD     		pop	{r3, pc}
  73              	.L4:
  74 002e 00BF     		.align	2
  75              	.L3:
  76 0030 00000000 		.word	.LANCHOR0
  77 0034 00000000 		.word	.LANCHOR1
  78 0038 A0590F00 		.word	1005984
  79              		.cfi_endproc
  80              	.LFE123:
  82              		.section	.text.delay_us,"ax",%progbits
  83              		.align	1
  84              		.global	delay_us
  85              		.syntax unified
  86              		.thumb
  87              		.thumb_func
  88              		.fpu fpv4-sp-d16
  90              	delay_us:
  91              	.LVL2:
  92              	.LFB124:
  25:SYS/delay/delay.c **** 
ARM GAS  /var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s 			page 3


  26:SYS/delay/delay.c **** void delay_us(u32 nus)
  27:SYS/delay/delay.c **** {
  93              		.loc 1 27 1 is_stmt 1 view -0
  94              		.cfi_startproc
  95              		@ args = 0, pretend = 0, frame = 0
  96              		@ frame_needed = 0, uses_anonymous_args = 0
  97              		@ link register save eliminated.
  98              		.loc 1 27 1 is_stmt 0 view .LVU17
  99 0000 10B4     		push	{r4}
 100              	.LCFI1:
 101              		.cfi_def_cfa_offset 4
 102              		.cfi_offset 4, -4
  28:SYS/delay/delay.c **** 	nus *= 2;
 103              		.loc 1 28 2 is_stmt 1 view .LVU18
 104              	.LVL3:
  29:SYS/delay/delay.c **** 	u32 ticks;
 105              		.loc 1 29 2 view .LVU19
  30:SYS/delay/delay.c **** 	u32 told, tnow, tcnt = 0;
 106              		.loc 1 30 2 view .LVU20
  31:SYS/delay/delay.c **** 	u32 reload = SysTick->LOAD; //LOAD的值
 107              		.loc 1 31 2 view .LVU21
 108              		.loc 1 31 6 is_stmt 0 view .LVU22
 109 0002 4FF0E022 		mov	r2, #-536813568
 110 0006 5469     		ldr	r4, [r2, #20]
 111              	.LVL4:
  32:SYS/delay/delay.c **** 	ticks = nus * fac_us;		//需要的节拍数
 112              		.loc 1 32 2 is_stmt 1 view .LVU23
 113              		.loc 1 32 14 is_stmt 0 view .LVU24
 114 0008 0D4B     		ldr	r3, .L12
 115 000a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 116              		.loc 1 32 8 view .LVU25
 117 000c 00FB03F3 		mul	r3, r0, r3
 118 0010 4FEA430C 		lsl	ip, r3, #1
 119              	.LVL5:
  33:SYS/delay/delay.c **** 	told = SysTick->VAL;		//刚进入时的计数器值
 120              		.loc 1 33 2 is_stmt 1 view .LVU26
 121              		.loc 1 33 7 is_stmt 0 view .LVU27
 122 0014 9369     		ldr	r3, [r2, #24]
 123              	.LVL6:
  30:SYS/delay/delay.c **** 	u32 reload = SysTick->LOAD; //LOAD的值
 124              		.loc 1 30 18 view .LVU28
 125 0016 0021     		movs	r1, #0
 126 0018 04E0     		b	.L9
 127              	.LVL7:
 128              	.L7:
  34:SYS/delay/delay.c **** 	while (1)
  35:SYS/delay/delay.c **** 	{
  36:SYS/delay/delay.c **** 		tnow = SysTick->VAL;
  37:SYS/delay/delay.c **** 		if (tnow != told)
  38:SYS/delay/delay.c **** 		{
  39:SYS/delay/delay.c **** 			if (tnow < told)
  40:SYS/delay/delay.c **** 				tcnt += told - tnow; //这里注意一下SYSTICK是一个递减的计数器就可以了.
  41:SYS/delay/delay.c **** 			else
  42:SYS/delay/delay.c **** 				tcnt += reload - tnow + told;
 129              		.loc 1 42 5 is_stmt 1 view .LVU29
 130              		.loc 1 42 20 is_stmt 0 view .LVU30
 131 001a E01A     		subs	r0, r4, r3
ARM GAS  /var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s 			page 4


 132              		.loc 1 42 27 view .LVU31
 133 001c 0244     		add	r2, r2, r0
 134              	.LVL8:
 135              		.loc 1 42 10 view .LVU32
 136 001e 1144     		add	r1, r1, r2
 137              	.LVL9:
 138              	.L8:
  43:SYS/delay/delay.c **** 			told = tnow;
 139              		.loc 1 43 4 is_stmt 1 view .LVU33
  44:SYS/delay/delay.c **** 			if (tcnt >= ticks)
 140              		.loc 1 44 4 view .LVU34
 141              		.loc 1 44 7 is_stmt 0 view .LVU35
 142 0020 6145     		cmp	r1, ip
 143 0022 09D2     		bcs	.L11
 144              	.LVL10:
 145              	.L9:
  30:SYS/delay/delay.c **** 	u32 reload = SysTick->LOAD; //LOAD的值
 146              		.loc 1 30 18 view .LVU36
 147 0024 1A46     		mov	r2, r3
 148              	.LVL11:
 149              	.L6:
  34:SYS/delay/delay.c **** 	{
 150              		.loc 1 34 2 is_stmt 1 view .LVU37
  36:SYS/delay/delay.c **** 		if (tnow != told)
 151              		.loc 1 36 3 view .LVU38
  36:SYS/delay/delay.c **** 		if (tnow != told)
 152              		.loc 1 36 8 is_stmt 0 view .LVU39
 153 0026 4FF0E023 		mov	r3, #-536813568
 154 002a 9B69     		ldr	r3, [r3, #24]
 155              	.LVL12:
  37:SYS/delay/delay.c **** 		{
 156              		.loc 1 37 3 is_stmt 1 view .LVU40
  37:SYS/delay/delay.c **** 		{
 157              		.loc 1 37 6 is_stmt 0 view .LVU41
 158 002c 9A42     		cmp	r2, r3
 159 002e FAD0     		beq	.L6
  39:SYS/delay/delay.c **** 				tcnt += told - tnow; //这里注意一下SYSTICK是一个递减的计数器就可以了.
 160              		.loc 1 39 4 is_stmt 1 view .LVU42
  39:SYS/delay/delay.c **** 				tcnt += told - tnow; //这里注意一下SYSTICK是一个递减的计数器就可以了.
 161              		.loc 1 39 7 is_stmt 0 view .LVU43
 162 0030 F3D9     		bls	.L7
  40:SYS/delay/delay.c **** 			else
 163              		.loc 1 40 5 is_stmt 1 view .LVU44
  40:SYS/delay/delay.c **** 			else
 164              		.loc 1 40 18 is_stmt 0 view .LVU45
 165 0032 D21A     		subs	r2, r2, r3
 166              	.LVL13:
  40:SYS/delay/delay.c **** 			else
 167              		.loc 1 40 10 view .LVU46
 168 0034 1144     		add	r1, r1, r2
 169              	.LVL14:
  40:SYS/delay/delay.c **** 			else
 170              		.loc 1 40 10 view .LVU47
 171 0036 F3E7     		b	.L8
 172              	.LVL15:
 173              	.L11:
  45:SYS/delay/delay.c **** 				break; //时间超过/等于要延迟的时间,则退出.
ARM GAS  /var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s 			page 5


  46:SYS/delay/delay.c **** 		}
  47:SYS/delay/delay.c **** 	};
  48:SYS/delay/delay.c **** }
 174              		.loc 1 48 1 view .LVU48
 175 0038 5DF8044B 		ldr	r4, [sp], #4
 176              	.LCFI2:
 177              		.cfi_restore 4
 178              		.cfi_def_cfa_offset 0
 179              	.LVL16:
 180              		.loc 1 48 1 view .LVU49
 181 003c 7047     		bx	lr
 182              	.L13:
 183 003e 00BF     		.align	2
 184              	.L12:
 185 0040 00000000 		.word	.LANCHOR0
 186              		.cfi_endproc
 187              	.LFE124:
 189              		.section	.text.delay_ms,"ax",%progbits
 190              		.align	1
 191              		.global	delay_ms
 192              		.syntax unified
 193              		.thumb
 194              		.thumb_func
 195              		.fpu fpv4-sp-d16
 197              	delay_ms:
 198              	.LVL17:
 199              	.LFB125:
  49:SYS/delay/delay.c **** 
  50:SYS/delay/delay.c **** void delay_ms(uint32_t MS)
  51:SYS/delay/delay.c **** {
 200              		.loc 1 51 1 is_stmt 1 view -0
 201              		.cfi_startproc
 202              		@ args = 0, pretend = 0, frame = 0
 203              		@ frame_needed = 0, uses_anonymous_args = 0
 204              		.loc 1 51 1 is_stmt 0 view .LVU51
 205 0000 10B5     		push	{r4, lr}
 206              	.LCFI3:
 207              		.cfi_def_cfa_offset 8
 208              		.cfi_offset 4, -8
 209              		.cfi_offset 14, -4
  52:SYS/delay/delay.c **** 	while (MS--)
 210              		.loc 1 52 2 is_stmt 1 view .LVU52
 211              		.loc 1 52 8 is_stmt 0 view .LVU53
 212 0002 04E0     		b	.L15
 213              	.LVL18:
 214              	.L16:
  53:SYS/delay/delay.c **** 	{
  54:SYS/delay/delay.c **** 		delay_us(REAL_MS);
 215              		.loc 1 54 3 is_stmt 1 view .LVU54
 216 0004 4FF47A70 		mov	r0, #1000
 217 0008 FFF7FEFF 		bl	delay_us
 218              	.LVL19:
  52:SYS/delay/delay.c **** 	while (MS--)
 219              		.loc 1 52 11 is_stmt 0 view .LVU55
 220 000c 2046     		mov	r0, r4
 221              	.LVL20:
 222              	.L15:
ARM GAS  /var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s 			page 6


  52:SYS/delay/delay.c **** 	while (MS--)
 223              		.loc 1 52 8 is_stmt 1 view .LVU56
  52:SYS/delay/delay.c **** 	while (MS--)
 224              		.loc 1 52 11 is_stmt 0 view .LVU57
 225 000e 441E     		subs	r4, r0, #1
 226              	.LVL21:
  52:SYS/delay/delay.c **** 	while (MS--)
 227              		.loc 1 52 8 view .LVU58
 228 0010 0028     		cmp	r0, #0
 229 0012 F7D1     		bne	.L16
  55:SYS/delay/delay.c **** 	}
  56:SYS/delay/delay.c **** }
 230              		.loc 1 56 1 view .LVU59
 231 0014 10BD     		pop	{r4, pc}
 232              		.loc 1 56 1 view .LVU60
 233              		.cfi_endproc
 234              	.LFE125:
 236              		.section	.bss.fac_ms,"aw",%nobits
 237              		.align	1
 238              		.set	.LANCHOR1,. + 0
 241              	fac_ms:
 242 0000 0000     		.space	2
 243              		.section	.bss.fac_us,"aw",%nobits
 244              		.set	.LANCHOR0,. + 0
 247              	fac_us:
 248 0000 00       		.space	1
 249              		.section	.bss.us_time,"aw",%nobits
 250              		.align	2
 253              	us_time:
 254 0000 00000000 		.space	4
 255              		.text
 256              	.Letext0:
 257              		.file 2 "/usr/local/arm-none-eabi-gcc/gcc-arm-none-eabi-10-2020-q4-major/arm-none-eabi/include/mac
 258              		.file 3 "/usr/local/arm-none-eabi-gcc/gcc-arm-none-eabi-10-2020-q4-major/arm-none-eabi/include/sys
 259              		.file 4 "F4_CORE/core_cm4.h"
 260              		.file 5 "USER/stm32f4xx.h"
 261              		.file 6 "FWLIB/inc/misc.h"
ARM GAS  /var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s 			page 7


DEFINED SYMBOLS
                            *ABS*:0000000000000000 delay.c
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:18     .text.delay_init:0000000000000000 $t
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:26     .text.delay_init:0000000000000000 delay_init
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:76     .text.delay_init:0000000000000030 $d
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:83     .text.delay_us:0000000000000000 $t
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:90     .text.delay_us:0000000000000000 delay_us
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:185    .text.delay_us:0000000000000040 $d
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:190    .text.delay_ms:0000000000000000 $t
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:197    .text.delay_ms:0000000000000000 delay_ms
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:237    .bss.fac_ms:0000000000000000 $d
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:241    .bss.fac_ms:0000000000000000 fac_ms
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:247    .bss.fac_us:0000000000000000 fac_us
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:248    .bss.fac_us:0000000000000000 $d
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:250    .bss.us_time:0000000000000000 $d
/var/folders/lx/hc4sn_b53233_zkc9xbbl97r0000gp/T//ccBhbTef.s:253    .bss.us_time:0000000000000000 us_time

UNDEFINED SYMBOLS
SysTick_CLKSourceConfig
