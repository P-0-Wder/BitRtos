ARM GAS  /tmp/cc88rmZj.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"drv_timer.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.DrvTimer_Obj_Init,"ax",%progbits
  18              		.align	1
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu fpv4-sp-d16
  24              	DrvTimer_Obj_Init:
  25              	.LFB123:
  26              		.file 1 "Drv/drv_timer.c"
   1:Drv/drv_timer.c **** #include "drv_timer.h"
   2:Drv/drv_timer.c **** 
   3:Drv/drv_timer.c **** /* internal function */
   4:Drv/drv_timer.c **** 
   5:Drv/drv_timer.c **** /* internal variable */
   6:Drv/drv_timer.c **** 
   7:Drv/drv_timer.c **** /* external function */
   8:Drv/drv_timer.c **** static bool DrvTimer_Obj_Init(DrvTimer_Obj_TypeDef *obj);
   9:Drv/drv_timer.c **** static bool DrvTimer_Ctl(DrvTimer_CMD_List cmd, uint32_t p_data, uint16_t len);
  10:Drv/drv_timer.c **** static int32_t DrvTImer_GetEncoder(DrvTimer_Obj_TypeDef *obj);
  11:Drv/drv_timer.c **** 
  12:Drv/drv_timer.c **** /* external variable */
  13:Drv/drv_timer.c **** DrvTimer_TypeDef DrvTimer = {
  14:Drv/drv_timer.c ****     .obj_clear = DrvTimer_Obj_Init,
  15:Drv/drv_timer.c ****     .ctl = DrvTimer_Ctl,
  16:Drv/drv_timer.c ****     .get = DrvTImer_GetEncoder,
  17:Drv/drv_timer.c **** };
  18:Drv/drv_timer.c **** 
  19:Drv/drv_timer.c **** static bool DrvTimer_Obj_Init(DrvTimer_Obj_TypeDef *obj)
  20:Drv/drv_timer.c **** {
  27              		.loc 1 20 0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		@ link register save eliminated.
  32              	.LVL0:
  21:Drv/drv_timer.c ****     if (obj == NULL)
  33              		.loc 1 21 0
  34 0000 50B1     		cbz	r0, .L3
  22:Drv/drv_timer.c ****         return false;
  23:Drv/drv_timer.c **** 
  24:Drv/drv_timer.c ****     obj->irq = false;
ARM GAS  /tmp/cc88rmZj.s 			page 2


  35              		.loc 1 24 0
  36 0002 0022     		movs	r2, #0
  37 0004 0273     		strb	r2, [r0, #12]
  25:Drv/drv_timer.c ****     obj->period = 0;
  38              		.loc 1 25 0
  39 0006 4260     		str	r2, [r0, #4]
  26:Drv/drv_timer.c ****     obj->PreemptionPriority = 0;
  40              		.loc 1 26 0
  41 0008 4273     		strb	r2, [r0, #13]
  27:Drv/drv_timer.c ****     obj->Prescaler = 0;
  42              		.loc 1 27 0
  43 000a 8260     		str	r2, [r0, #8]
  28:Drv/drv_timer.c ****     obj->SubPriority = 0;
  44              		.loc 1 28 0
  45 000c 8273     		strb	r2, [r0, #14]
  29:Drv/drv_timer.c ****     obj->timerx = Timer_None;
  46              		.loc 1 29 0
  47 000e 0321     		movs	r1, #3
  48 0010 4170     		strb	r1, [r0, #1]
  30:Drv/drv_timer.c ****     obj->cnt = 0;
  49              		.loc 1 30 0
  50 0012 4261     		str	r2, [r0, #20]
  31:Drv/drv_timer.c **** 
  32:Drv/drv_timer.c ****     return true;
  51              		.loc 1 32 0
  52 0014 0120     		movs	r0, #1
  53              	.LVL1:
  54 0016 7047     		bx	lr
  55              	.LVL2:
  56              	.L3:
  22:Drv/drv_timer.c **** 
  57              		.loc 1 22 0
  58 0018 0020     		movs	r0, #0
  59              	.LVL3:
  33:Drv/drv_timer.c **** }
  60              		.loc 1 33 0
  61 001a 7047     		bx	lr
  62              		.cfi_endproc
  63              	.LFE123:
  65              		.section	.text.DrvTImer_GetEncoder,"ax",%progbits
  66              		.align	1
  67              		.syntax unified
  68              		.thumb
  69              		.thumb_func
  70              		.fpu fpv4-sp-d16
  72              	DrvTImer_GetEncoder:
  73              	.LFB125:
  34:Drv/drv_timer.c **** 
  35:Drv/drv_timer.c **** static bool DrvTimer_Ctl(DrvTimer_CMD_List cmd, uint32_t p_data, uint16_t len)
  36:Drv/drv_timer.c **** {
  37:Drv/drv_timer.c ****     switch (cmd)
  38:Drv/drv_timer.c ****     {
  39:Drv/drv_timer.c ****     case DrvTimer_Encoder_Mode:
  40:Drv/drv_timer.c ****         if ((len != sizeof(DrvTimer_Obj_TypeDef)) || (p_data == 0))
  41:Drv/drv_timer.c ****             return false;
  42:Drv/drv_timer.c **** 
  43:Drv/drv_timer.c ****         ((DrvTimer_Obj_TypeDef *)p_data)->mode = DrvTimer_Encoder_Mode;
ARM GAS  /tmp/cc88rmZj.s 			page 3


  44:Drv/drv_timer.c **** 
  45:Drv/drv_timer.c ****         if ((((DrvTimer_Obj_TypeDef *)p_data)->timerx < Timer_2) ||
  46:Drv/drv_timer.c ****             (((DrvTimer_Obj_TypeDef *)p_data)->timerx > Timer_4) ||
  47:Drv/drv_timer.c ****             (((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_a == ((DrvTimer_Obj_TypeDef *)p_data)->enc_ch
  48:Drv/drv_timer.c ****             (((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_a < TIM_Channel_1) ||
  49:Drv/drv_timer.c ****             (((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_a < TIM_Channel_4) ||
  50:Drv/drv_timer.c ****             (((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_b < TIM_Channel_1) ||
  51:Drv/drv_timer.c ****             (((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_b < TIM_Channel_4))
  52:Drv/drv_timer.c ****             return false;
  53:Drv/drv_timer.c **** 
  54:Drv/drv_timer.c ****         periph_Timer_Encoder_Mode_Init(((DrvTimer_Obj_TypeDef *)p_data)->timerx,
  55:Drv/drv_timer.c ****                                        ((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_a,
  56:Drv/drv_timer.c ****                                        ((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_b);
  57:Drv/drv_timer.c ****         return true;
  58:Drv/drv_timer.c **** 
  59:Drv/drv_timer.c ****     case DrvTimer_Counter_Mode:
  60:Drv/drv_timer.c ****         /* TODO */
  61:Drv/drv_timer.c ****         /* need set Counter IRQ Callback */
  62:Drv/drv_timer.c ****         /* not inuse yet */
  63:Drv/drv_timer.c ****         return false;
  64:Drv/drv_timer.c **** 
  65:Drv/drv_timer.c ****     default:
  66:Drv/drv_timer.c ****         return false;
  67:Drv/drv_timer.c ****     }
  68:Drv/drv_timer.c **** }
  69:Drv/drv_timer.c **** 
  70:Drv/drv_timer.c **** static int32_t DrvTImer_GetEncoder(DrvTimer_Obj_TypeDef *obj)
  71:Drv/drv_timer.c **** {
  74              		.loc 1 71 0
  75              		.cfi_startproc
  76              		@ args = 0, pretend = 0, frame = 0
  77              		@ frame_needed = 0, uses_anonymous_args = 0
  78              	.LVL4:
  72:Drv/drv_timer.c ****     if ((obj == NULL) || (obj->mode != DrvTimer_Encoder_Mode))
  79              		.loc 1 72 0
  80 0000 68B1     		cbz	r0, .L6
  71:Drv/drv_timer.c ****     if ((obj == NULL) || (obj->mode != DrvTimer_Encoder_Mode))
  81              		.loc 1 71 0 discriminator 1
  82 0002 10B5     		push	{r4, lr}
  83              	.LCFI0:
  84              		.cfi_def_cfa_offset 8
  85              		.cfi_offset 4, -8
  86              		.cfi_offset 14, -4
  87 0004 0446     		mov	r4, r0
  88              		.loc 1 72 0 discriminator 1
  89 0006 0278     		ldrb	r2, [r0]	@ zero_extendqisi2
  90 0008 032A     		cmp	r2, #3
  91 000a 01D0     		beq	.L12
  73:Drv/drv_timer.c ****         return 0;
  92              		.loc 1 73 0
  93 000c 0020     		movs	r0, #0
  94              	.LVL5:
  74:Drv/drv_timer.c **** 
  75:Drv/drv_timer.c ****     obj->cnt += periph_Timer_GetEncoder_Input(obj->timerx);
  76:Drv/drv_timer.c **** 
  77:Drv/drv_timer.c ****     return obj->cnt;
  78:Drv/drv_timer.c **** }
ARM GAS  /tmp/cc88rmZj.s 			page 4


  95              		.loc 1 78 0
  96 000e 10BD     		pop	{r4, pc}
  97              	.LVL6:
  98              	.L12:
  75:Drv/drv_timer.c **** 
  99              		.loc 1 75 0
 100 0010 4078     		ldrb	r0, [r0, #1]	@ zero_extendqisi2
 101              	.LVL7:
 102 0012 FFF7FEFF 		bl	periph_Timer_GetEncoder_Input
 103              	.LVL8:
 104 0016 6369     		ldr	r3, [r4, #20]
 105 0018 1844     		add	r0, r0, r3
 106 001a 6061     		str	r0, [r4, #20]
  77:Drv/drv_timer.c **** }
 107              		.loc 1 77 0
 108 001c 10BD     		pop	{r4, pc}
 109              	.LVL9:
 110              	.L6:
 111              	.LCFI1:
 112              		.cfi_def_cfa_offset 0
 113              		.cfi_restore 4
 114              		.cfi_restore 14
  73:Drv/drv_timer.c **** 
 115              		.loc 1 73 0
 116 001e 0020     		movs	r0, #0
 117              	.LVL10:
 118 0020 7047     		bx	lr
 119              		.cfi_endproc
 120              	.LFE125:
 122              		.section	.text.DrvTimer_Ctl,"ax",%progbits
 123              		.align	1
 124              		.syntax unified
 125              		.thumb
 126              		.thumb_func
 127              		.fpu fpv4-sp-d16
 129              	DrvTimer_Ctl:
 130              	.LFB124:
  36:Drv/drv_timer.c ****     switch (cmd)
 131              		.loc 1 36 0
 132              		.cfi_startproc
 133              		@ args = 0, pretend = 0, frame = 0
 134              		@ frame_needed = 0, uses_anonymous_args = 0
 135              	.LVL11:
  37:Drv/drv_timer.c ****     {
 136              		.loc 1 37 0
 137 0000 0328     		cmp	r0, #3
 138 0002 19D1     		bne	.L23
  40:Drv/drv_timer.c ****             return false;
 139              		.loc 1 40 0
 140 0004 182A     		cmp	r2, #24
 141 0006 01D0     		beq	.L28
  41:Drv/drv_timer.c **** 
 142              		.loc 1 41 0
 143 0008 0020     		movs	r0, #0
 144              	.LVL12:
 145 000a 7047     		bx	lr
 146              	.LVL13:
ARM GAS  /tmp/cc88rmZj.s 			page 5


 147              	.L28:
  40:Drv/drv_timer.c ****             return false;
 148              		.loc 1 40 0 discriminator 1
 149 000c B1B1     		cbz	r1, .L18
  36:Drv/drv_timer.c ****     switch (cmd)
 150              		.loc 1 36 0
 151 000e 08B5     		push	{r3, lr}
 152              	.LCFI2:
 153              		.cfi_def_cfa_offset 8
 154              		.cfi_offset 3, -8
 155              		.cfi_offset 14, -4
  43:Drv/drv_timer.c **** 
 156              		.loc 1 43 0
 157 0010 0323     		movs	r3, #3
 158 0012 0B70     		strb	r3, [r1]
  46:Drv/drv_timer.c ****             (((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_a == ((DrvTimer_Obj_TypeDef *)p_data)->enc_ch
 159              		.loc 1 46 0
 160 0014 4878     		ldrb	r0, [r1, #1]	@ zero_extendqisi2
 161              	.LVL14:
  45:Drv/drv_timer.c ****             (((DrvTimer_Obj_TypeDef *)p_data)->timerx > Timer_4) ||
 162              		.loc 1 45 0
 163 0016 0228     		cmp	r0, #2
 164 0018 12D8     		bhi	.L19
  47:Drv/drv_timer.c ****             (((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_a < TIM_Channel_1) ||
 165              		.loc 1 47 0
 166 001a 0B8A     		ldrh	r3, [r1, #16]
 167 001c 4A8A     		ldrh	r2, [r1, #18]
 168              	.LVL15:
 169 001e 9342     		cmp	r3, r2
 170 0020 10D0     		beq	.L20
  49:Drv/drv_timer.c ****             (((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_b < TIM_Channel_1) ||
 171              		.loc 1 49 0
 172 0022 0B2B     		cmp	r3, #11
 173 0024 10D9     		bls	.L21
  50:Drv/drv_timer.c ****             (((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_b < TIM_Channel_4))
 174              		.loc 1 50 0
 175 0026 0B2A     		cmp	r2, #11
 176 0028 01D8     		bhi	.L29
  52:Drv/drv_timer.c **** 
 177              		.loc 1 52 0
 178 002a 0020     		movs	r0, #0
  68:Drv/drv_timer.c **** 
 179              		.loc 1 68 0
 180 002c 08BD     		pop	{r3, pc}
 181              	.L29:
  54:Drv/drv_timer.c ****                                        ((DrvTimer_Obj_TypeDef *)p_data)->enc_ch_a,
 182              		.loc 1 54 0
 183 002e 1946     		mov	r1, r3
 184              	.LVL16:
 185 0030 FFF7FEFF 		bl	periph_Timer_Encoder_Mode_Init
 186              	.LVL17:
  57:Drv/drv_timer.c **** 
 187              		.loc 1 57 0
 188 0034 0120     		movs	r0, #1
 189 0036 08BD     		pop	{r3, pc}
 190              	.LVL18:
 191              	.L23:
ARM GAS  /tmp/cc88rmZj.s 			page 6


 192              	.LCFI3:
 193              		.cfi_def_cfa_offset 0
 194              		.cfi_restore 3
 195              		.cfi_restore 14
  63:Drv/drv_timer.c **** 
 196              		.loc 1 63 0
 197 0038 0020     		movs	r0, #0
 198              	.LVL19:
 199 003a 7047     		bx	lr
 200              	.LVL20:
 201              	.L18:
  41:Drv/drv_timer.c **** 
 202              		.loc 1 41 0
 203 003c 0020     		movs	r0, #0
 204              	.LVL21:
 205 003e 7047     		bx	lr
 206              	.L19:
 207              	.LCFI4:
 208              		.cfi_def_cfa_offset 8
 209              		.cfi_offset 3, -8
 210              		.cfi_offset 14, -4
  52:Drv/drv_timer.c **** 
 211              		.loc 1 52 0
 212 0040 0020     		movs	r0, #0
 213 0042 08BD     		pop	{r3, pc}
 214              	.LVL22:
 215              	.L20:
 216 0044 0020     		movs	r0, #0
 217 0046 08BD     		pop	{r3, pc}
 218              	.L21:
 219 0048 0020     		movs	r0, #0
 220 004a 08BD     		pop	{r3, pc}
 221              		.cfi_endproc
 222              	.LFE124:
 224              		.global	DrvTimer
 225              		.section	.data.DrvTimer,"aw",%progbits
 226              		.align	2
 229              	DrvTimer:
 230 0000 00000000 		.word	DrvTimer_Obj_Init
 231 0004 00000000 		.word	DrvTimer_Ctl
 232 0008 00000000 		.word	DrvTImer_GetEncoder
 233              		.text
 234              	.Letext0:
 235              		.file 2 "/usr/include/newlib/machine/_default_types.h"
 236              		.file 3 "/usr/include/newlib/sys/_stdint.h"
 237              		.file 4 "/usr/include/newlib/sys/lock.h"
 238              		.file 5 "/usr/include/newlib/sys/_types.h"
 239              		.file 6 "/usr/lib/gcc/arm-none-eabi/6.3.1/include/stddef.h"
 240              		.file 7 "/usr/include/newlib/sys/reent.h"
 241              		.file 8 "F4_CORE/core_cm4.h"
 242              		.file 9 "USER/system_stm32f4xx.h"
 243              		.file 10 "USER/stm32f4xx.h"
 244              		.file 11 "Bsp/periph_timer.h"
 245              		.file 12 "Drv/drv_timer.h"
ARM GAS  /tmp/cc88rmZj.s 			page 7


DEFINED SYMBOLS
                            *ABS*:0000000000000000 drv_timer.c
     /tmp/cc88rmZj.s:18     .text.DrvTimer_Obj_Init:0000000000000000 $t
     /tmp/cc88rmZj.s:24     .text.DrvTimer_Obj_Init:0000000000000000 DrvTimer_Obj_Init
     /tmp/cc88rmZj.s:66     .text.DrvTImer_GetEncoder:0000000000000000 $t
     /tmp/cc88rmZj.s:72     .text.DrvTImer_GetEncoder:0000000000000000 DrvTImer_GetEncoder
     /tmp/cc88rmZj.s:123    .text.DrvTimer_Ctl:0000000000000000 $t
     /tmp/cc88rmZj.s:129    .text.DrvTimer_Ctl:0000000000000000 DrvTimer_Ctl
     /tmp/cc88rmZj.s:229    .data.DrvTimer:0000000000000000 DrvTimer
     /tmp/cc88rmZj.s:226    .data.DrvTimer:0000000000000000 $d
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
periph_Timer_GetEncoder_Input
periph_Timer_Encoder_Mode_Init
