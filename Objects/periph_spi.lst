ARM GAS  /tmp/ccy6Moss.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"periph_spi.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.periph_SPI_DeInit,"ax",%progbits
  18              		.align	1
  19              		.global	periph_SPI_DeInit
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	periph_SPI_DeInit:
  27              	.LVL0:
  28              	.LFB123:
  29              		.file 1 "Bsp/periph_spi.c"
   1:Bsp/periph_spi.c **** #include "stm32f4xx_spi.h"
   2:Bsp/periph_spi.c **** #include "periph_gpio.h"
   3:Bsp/periph_spi.c **** #include "periph_spi.h"
   4:Bsp/periph_spi.c **** 
   5:Bsp/periph_spi.c **** uint16_t SpiErrorCount = 0;
   6:Bsp/periph_spi.c **** uint16_t SpiErrorCount2 = 0;
   7:Bsp/periph_spi.c **** 
   8:Bsp/periph_spi.c **** static void (*SPI_IO_Init[SPI_PORT_SUM])() = {GPIO_SPI1_IO_Init, GPIO_SPI2_IO_Init, GPIO_SPI3_IO_In
   9:Bsp/periph_spi.c **** 
  10:Bsp/periph_spi.c **** static SPI_TypeDef *SPI_PORT[SPI_PORT_SUM] = {SPI1, SPI2, SPI3};
  11:Bsp/periph_spi.c **** 
  12:Bsp/periph_spi.c **** static uint32_t SPI_CLK[SPI_PORT_SUM] = {RCC_APB2Periph_SPI1, RCC_APB1Periph_SPI2, RCC_APB1Periph_S
  13:Bsp/periph_spi.c **** 
  14:Bsp/periph_spi.c **** static const uint16_t divisorMap[] = {
  15:Bsp/periph_spi.c **** 	SPI_BaudRatePrescaler_256, // SPI_CLOCK_INITIALIZATON      328.125 KBits/s
  16:Bsp/periph_spi.c **** 	SPI_BaudRatePrescaler_128, // SPI_CLOCK_SLOW               656.25 KBits/s
  17:Bsp/periph_spi.c **** 	SPI_BaudRatePrescaler_8,   // SPI_CLOCK_STANDARD           10.5 MBits/s
  18:Bsp/periph_spi.c **** 	SPI_BaudRatePrescaler_4,   // SPI_CLOCK_FAST               21.0 MBits/s
  19:Bsp/periph_spi.c **** 	SPI_BaudRatePrescaler_2	   // SPI_CLOCK_ULTRAFAST          42.0 MBits/s
  20:Bsp/periph_spi.c **** };
  21:Bsp/periph_spi.c **** 
  22:Bsp/periph_spi.c **** void periph_SPI_DeInit(SPI_List SPIx)
  23:Bsp/periph_spi.c **** {
  30              		.loc 1 23 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 23 1 is_stmt 0 view .LVU1
  35 0000 08B5     		push	{r3, lr}
ARM GAS  /tmp/ccy6Moss.s 			page 2


  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 8
  38              		.cfi_offset 3, -8
  39              		.cfi_offset 14, -4
  24:Bsp/periph_spi.c **** 	SPI_I2S_DeInit(SPI_PORT[SPIx]);
  40              		.loc 1 24 2 is_stmt 1 view .LVU2
  41 0002 034B     		ldr	r3, .L3
  42 0004 53F82000 		ldr	r0, [r3, r0, lsl #2]
  43              	.LVL1:
  44              		.loc 1 24 2 is_stmt 0 view .LVU3
  45 0008 FFF7FEFF 		bl	SPI_I2S_DeInit
  46              	.LVL2:
  25:Bsp/periph_spi.c **** }
  47              		.loc 1 25 1 view .LVU4
  48 000c 08BD     		pop	{r3, pc}
  49              	.L4:
  50 000e 00BF     		.align	2
  51              	.L3:
  52 0010 00000000 		.word	.LANCHOR0
  53              		.cfi_endproc
  54              	.LFE123:
  56              		.section	.text.periph_SPI_Init,"ax",%progbits
  57              		.align	1
  58              		.global	periph_SPI_Init
  59              		.syntax unified
  60              		.thumb
  61              		.thumb_func
  62              		.fpu fpv4-sp-d16
  64              	periph_SPI_Init:
  65              	.LVL3:
  66              	.LFB124:
  26:Bsp/periph_spi.c **** 
  27:Bsp/periph_spi.c **** void periph_SPI_Init(SPI_List SPIx, SPIClockSpeed_e speed, uint16_t CPOL, uint16_t CPHA)
  28:Bsp/periph_spi.c **** {
  67              		.loc 1 28 1 is_stmt 1 view -0
  68              		.cfi_startproc
  69              		@ args = 0, pretend = 0, frame = 24
  70              		@ frame_needed = 0, uses_anonymous_args = 0
  71              		.loc 1 28 1 is_stmt 0 view .LVU6
  72 0000 F0B5     		push	{r4, r5, r6, r7, lr}
  73              	.LCFI1:
  74              		.cfi_def_cfa_offset 20
  75              		.cfi_offset 4, -20
  76              		.cfi_offset 5, -16
  77              		.cfi_offset 6, -12
  78              		.cfi_offset 7, -8
  79              		.cfi_offset 14, -4
  80 0002 87B0     		sub	sp, sp, #28
  81              	.LCFI2:
  82              		.cfi_def_cfa_offset 48
  83 0004 0446     		mov	r4, r0
  84 0006 0D46     		mov	r5, r1
  85 0008 1746     		mov	r7, r2
  86 000a 1E46     		mov	r6, r3
  29:Bsp/periph_spi.c **** 	SPI_InitTypeDef SPI_InitStructure;
  87              		.loc 1 29 2 is_stmt 1 view .LVU7
  30:Bsp/periph_spi.c **** 	SPI_IO_Init[SPIx]();
ARM GAS  /tmp/ccy6Moss.s 			page 3


  88              		.loc 1 30 2 view .LVU8
  89              		.loc 1 30 13 is_stmt 0 view .LVU9
  90 000c 204B     		ldr	r3, .L9
  91              	.LVL4:
  92              		.loc 1 30 13 view .LVU10
  93 000e 53F82030 		ldr	r3, [r3, r0, lsl #2]
  94              		.loc 1 30 2 view .LVU11
  95 0012 9847     		blx	r3
  96              	.LVL5:
  31:Bsp/periph_spi.c **** 
  32:Bsp/periph_spi.c **** 	if (SPIx == SPI_1)
  97              		.loc 1 32 2 is_stmt 1 view .LVU12
  98              		.loc 1 32 5 is_stmt 0 view .LVU13
  99 0014 A4BB     		cbnz	r4, .L6
  33:Bsp/periph_spi.c **** 	{
  34:Bsp/periph_spi.c **** 		RCC_APB2PeriphClockCmd(SPI_CLK[SPIx], ENABLE);
 100              		.loc 1 34 3 is_stmt 1 view .LVU14
 101 0016 0121     		movs	r1, #1
 102 0018 1E4B     		ldr	r3, .L9+4
 103 001a 53F82400 		ldr	r0, [r3, r4, lsl #2]
 104 001e FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
 105              	.LVL6:
 106              	.L7:
  35:Bsp/periph_spi.c **** 	}
  36:Bsp/periph_spi.c **** 	else
  37:Bsp/periph_spi.c **** 	{
  38:Bsp/periph_spi.c **** 		RCC_APB1PeriphClockCmd(SPI_CLK[SPIx], ENABLE);
  39:Bsp/periph_spi.c **** 	}
  40:Bsp/periph_spi.c **** 
  41:Bsp/periph_spi.c **** 	SPI_I2S_DeInit(SPI_PORT[SPIx]);
 107              		.loc 1 41 2 view .LVU15
 108 0022 1D4B     		ldr	r3, .L9+8
 109 0024 53F82440 		ldr	r4, [r3, r4, lsl #2]
 110 0028 2046     		mov	r0, r4
 111 002a FFF7FEFF 		bl	SPI_I2S_DeInit
 112              	.LVL7:
  42:Bsp/periph_spi.c **** 	SPI_Cmd(SPI_PORT[SPIx], DISABLE);
 113              		.loc 1 42 2 view .LVU16
 114 002e 0021     		movs	r1, #0
 115 0030 2046     		mov	r0, r4
 116 0032 FFF7FEFF 		bl	SPI_Cmd
 117              	.LVL8:
  43:Bsp/periph_spi.c **** 
  44:Bsp/periph_spi.c **** 	SPI_InitStructure.SPI_Mode = SPI_Mode_Master;
 118              		.loc 1 44 2 view .LVU17
 119              		.loc 1 44 29 is_stmt 0 view .LVU18
 120 0036 4FF48273 		mov	r3, #260
 121 003a ADF80630 		strh	r3, [sp, #6]	@ movhi
  45:Bsp/periph_spi.c **** 	SPI_InitStructure.SPI_Direction = SPI_Direction_2Lines_FullDuplex;
 122              		.loc 1 45 2 is_stmt 1 view .LVU19
 123              		.loc 1 45 34 is_stmt 0 view .LVU20
 124 003e 0023     		movs	r3, #0
 125 0040 ADF80430 		strh	r3, [sp, #4]	@ movhi
  46:Bsp/periph_spi.c **** 	SPI_InitStructure.SPI_DataSize = SPI_DataSize_8b;
 126              		.loc 1 46 2 is_stmt 1 view .LVU21
 127              		.loc 1 46 33 is_stmt 0 view .LVU22
 128 0044 ADF80830 		strh	r3, [sp, #8]	@ movhi
ARM GAS  /tmp/ccy6Moss.s 			page 4


  47:Bsp/periph_spi.c **** 	SPI_InitStructure.SPI_NSS = SPI_NSS_Soft;
 129              		.loc 1 47 2 is_stmt 1 view .LVU23
 130              		.loc 1 47 28 is_stmt 0 view .LVU24
 131 0048 4FF40072 		mov	r2, #512
 132 004c ADF80E20 		strh	r2, [sp, #14]	@ movhi
  48:Bsp/periph_spi.c **** 	SPI_InitStructure.SPI_FirstBit = SPI_FirstBit_MSB;
 133              		.loc 1 48 2 is_stmt 1 view .LVU25
 134              		.loc 1 48 33 is_stmt 0 view .LVU26
 135 0050 ADF81230 		strh	r3, [sp, #18]	@ movhi
  49:Bsp/periph_spi.c **** 	SPI_InitStructure.SPI_CPOL = CPOL;
 136              		.loc 1 49 2 is_stmt 1 view .LVU27
 137              		.loc 1 49 29 is_stmt 0 view .LVU28
 138 0054 ADF80A70 		strh	r7, [sp, #10]	@ movhi
  50:Bsp/periph_spi.c **** 	SPI_InitStructure.SPI_CPHA = CPHA;
 139              		.loc 1 50 2 is_stmt 1 view .LVU29
 140              		.loc 1 50 29 is_stmt 0 view .LVU30
 141 0058 ADF80C60 		strh	r6, [sp, #12]	@ movhi
  51:Bsp/periph_spi.c **** 	SPI_InitStructure.SPI_CRCPolynomial = 7;
 142              		.loc 1 51 2 is_stmt 1 view .LVU31
 143              		.loc 1 51 38 is_stmt 0 view .LVU32
 144 005c 0723     		movs	r3, #7
 145 005e ADF81430 		strh	r3, [sp, #20]	@ movhi
  52:Bsp/periph_spi.c **** 	SPI_InitStructure.SPI_BaudRatePrescaler = divisorMap[(uint8_t)speed];
 146              		.loc 1 52 2 is_stmt 1 view .LVU33
 147              		.loc 1 52 54 is_stmt 0 view .LVU34
 148 0062 0E4B     		ldr	r3, .L9+12
 149 0064 33F81530 		ldrh	r3, [r3, r5, lsl #1]
 150              		.loc 1 52 42 view .LVU35
 151 0068 ADF81030 		strh	r3, [sp, #16]	@ movhi
  53:Bsp/periph_spi.c **** 	SPI_Init(SPI_PORT[SPIx], &SPI_InitStructure);
 152              		.loc 1 53 2 is_stmt 1 view .LVU36
 153 006c 01A9     		add	r1, sp, #4
 154 006e 2046     		mov	r0, r4
 155 0070 FFF7FEFF 		bl	SPI_Init
 156              	.LVL9:
  54:Bsp/periph_spi.c **** 
  55:Bsp/periph_spi.c **** 	SPI_Cmd(SPI_PORT[SPIx], ENABLE);
 157              		.loc 1 55 2 view .LVU37
 158 0074 0121     		movs	r1, #1
 159 0076 2046     		mov	r0, r4
 160 0078 FFF7FEFF 		bl	SPI_Cmd
 161              	.LVL10:
  56:Bsp/periph_spi.c **** }
 162              		.loc 1 56 1 is_stmt 0 view .LVU38
 163 007c 07B0     		add	sp, sp, #28
 164              	.LCFI3:
 165              		.cfi_remember_state
 166              		.cfi_def_cfa_offset 20
 167              		@ sp needed
 168 007e F0BD     		pop	{r4, r5, r6, r7, pc}
 169              	.L6:
 170              	.LCFI4:
 171              		.cfi_restore_state
  38:Bsp/periph_spi.c **** 	}
 172              		.loc 1 38 3 is_stmt 1 view .LVU39
 173 0080 0121     		movs	r1, #1
 174 0082 044B     		ldr	r3, .L9+4
ARM GAS  /tmp/ccy6Moss.s 			page 5


 175 0084 53F82400 		ldr	r0, [r3, r4, lsl #2]
 176 0088 FFF7FEFF 		bl	RCC_APB1PeriphClockCmd
 177              	.LVL11:
 178 008c C9E7     		b	.L7
 179              	.L10:
 180 008e 00BF     		.align	2
 181              	.L9:
 182 0090 00000000 		.word	.LANCHOR1
 183 0094 00000000 		.word	.LANCHOR2
 184 0098 00000000 		.word	.LANCHOR0
 185 009c 00000000 		.word	.LANCHOR3
 186              		.cfi_endproc
 187              	.LFE124:
 189              		.section	.text.periph_SPI_SetSpeed,"ax",%progbits
 190              		.align	1
 191              		.global	periph_SPI_SetSpeed
 192              		.syntax unified
 193              		.thumb
 194              		.thumb_func
 195              		.fpu fpv4-sp-d16
 197              	periph_SPI_SetSpeed:
 198              	.LVL12:
 199              	.LFB125:
  57:Bsp/periph_spi.c **** 
  58:Bsp/periph_spi.c **** void periph_SPI_SetSpeed(SPI_List SPIx, SPIClockSpeed_e speed)
  59:Bsp/periph_spi.c **** {
 200              		.loc 1 59 1 view -0
 201              		.cfi_startproc
 202              		@ args = 0, pretend = 0, frame = 0
 203              		@ frame_needed = 0, uses_anonymous_args = 0
 204              		.loc 1 59 1 is_stmt 0 view .LVU41
 205 0000 38B5     		push	{r3, r4, r5, lr}
 206              	.LCFI5:
 207              		.cfi_def_cfa_offset 16
 208              		.cfi_offset 3, -16
 209              		.cfi_offset 4, -12
 210              		.cfi_offset 5, -8
 211              		.cfi_offset 14, -4
 212 0002 0D46     		mov	r5, r1
  60:Bsp/periph_spi.c **** #define BR_CLEAR_MASK 0xFFC7
  61:Bsp/periph_spi.c **** 	SPI_Cmd(SPI_PORT[SPIx], DISABLE);
 213              		.loc 1 61 2 is_stmt 1 view .LVU42
 214 0004 0A4B     		ldr	r3, .L13
 215 0006 53F82040 		ldr	r4, [r3, r0, lsl #2]
 216 000a 0021     		movs	r1, #0
 217              	.LVL13:
 218              		.loc 1 61 2 is_stmt 0 view .LVU43
 219 000c 2046     		mov	r0, r4
 220              	.LVL14:
 221              		.loc 1 61 2 view .LVU44
 222 000e FFF7FEFF 		bl	SPI_Cmd
 223              	.LVL15:
  62:Bsp/periph_spi.c **** 
  63:Bsp/periph_spi.c **** 	uint16_t tempRegister = SPI_PORT[SPIx]->CR1;
 224              		.loc 1 63 2 is_stmt 1 view .LVU45
 225              		.loc 1 63 11 is_stmt 0 view .LVU46
 226 0012 2388     		ldrh	r3, [r4]
ARM GAS  /tmp/ccy6Moss.s 			page 6


 227 0014 9BB2     		uxth	r3, r3
 228              	.LVL16:
  64:Bsp/periph_spi.c **** 	tempRegister &= BR_CLEAR_MASK;
 229              		.loc 1 64 2 is_stmt 1 view .LVU47
 230              		.loc 1 64 15 is_stmt 0 view .LVU48
 231 0016 23F03803 		bic	r3, r3, #56
 232              	.LVL17:
  65:Bsp/periph_spi.c **** 	tempRegister |= divisorMap[speed];
 233              		.loc 1 65 2 is_stmt 1 view .LVU49
 234              		.loc 1 65 28 is_stmt 0 view .LVU50
 235 001a 064A     		ldr	r2, .L13+4
 236 001c 32F81520 		ldrh	r2, [r2, r5, lsl #1]
 237              		.loc 1 65 15 view .LVU51
 238 0020 1343     		orrs	r3, r3, r2
 239              	.LVL18:
  66:Bsp/periph_spi.c **** 	SPI_PORT[SPIx]->CR1 = tempRegister;
 240              		.loc 1 66 2 is_stmt 1 view .LVU52
 241              		.loc 1 66 22 is_stmt 0 view .LVU53
 242 0022 2380     		strh	r3, [r4]	@ movhi
  67:Bsp/periph_spi.c **** 	SPI_Cmd(SPI_PORT[SPIx], ENABLE);
 243              		.loc 1 67 2 is_stmt 1 view .LVU54
 244 0024 0121     		movs	r1, #1
 245 0026 2046     		mov	r0, r4
 246 0028 FFF7FEFF 		bl	SPI_Cmd
 247              	.LVL19:
  68:Bsp/periph_spi.c **** }
 248              		.loc 1 68 1 is_stmt 0 view .LVU55
 249 002c 38BD     		pop	{r3, r4, r5, pc}
 250              	.L14:
 251 002e 00BF     		.align	2
 252              	.L13:
 253 0030 00000000 		.word	.LANCHOR0
 254 0034 00000000 		.word	.LANCHOR3
 255              		.cfi_endproc
 256              	.LFE125:
 258              		.section	.text.periph_SPI_WriteByte,"ax",%progbits
 259              		.align	1
 260              		.global	periph_SPI_WriteByte
 261              		.syntax unified
 262              		.thumb
 263              		.thumb_func
 264              		.fpu fpv4-sp-d16
 266              	periph_SPI_WriteByte:
 267              	.LVL20:
 268              	.LFB126:
  69:Bsp/periph_spi.c **** 
  70:Bsp/periph_spi.c **** bool periph_SPI_WriteByte(SPI_List SPIx, uint8_t TxData)
  71:Bsp/periph_spi.c **** {
 269              		.loc 1 71 1 is_stmt 1 view -0
 270              		.cfi_startproc
 271              		@ args = 0, pretend = 0, frame = 0
 272              		@ frame_needed = 0, uses_anonymous_args = 0
 273              		.loc 1 71 1 is_stmt 0 view .LVU57
 274 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 275              	.LCFI6:
 276              		.cfi_def_cfa_offset 24
 277              		.cfi_offset 3, -24
ARM GAS  /tmp/ccy6Moss.s 			page 7


 278              		.cfi_offset 4, -20
 279              		.cfi_offset 5, -16
 280              		.cfi_offset 6, -12
 281              		.cfi_offset 7, -8
 282              		.cfi_offset 14, -4
 283 0002 0546     		mov	r5, r0
 284 0004 0F46     		mov	r7, r1
  72:Bsp/periph_spi.c **** 	uint16_t retry = 0;
 285              		.loc 1 72 2 is_stmt 1 view .LVU58
 286              	.LVL21:
  73:Bsp/periph_spi.c **** 	while (SPI_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_TXE) == RESET)
 287              		.loc 1 73 2 view .LVU59
  72:Bsp/periph_spi.c **** 	uint16_t retry = 0;
 288              		.loc 1 72 11 is_stmt 0 view .LVU60
 289 0006 0024     		movs	r4, #0
 290              	.LVL22:
 291              	.L16:
 292              		.loc 1 73 9 view .LVU61
 293 0008 0221     		movs	r1, #2
 294 000a 0A4B     		ldr	r3, .L22
 295 000c 53F82500 		ldr	r0, [r3, r5, lsl #2]
 296 0010 FFF7FEFF 		bl	SPI_I2S_GetFlagStatus
 297              	.LVL23:
 298              		.loc 1 73 8 view .LVU62
 299 0014 30B9     		cbnz	r0, .L21
  74:Bsp/periph_spi.c **** 	{
  75:Bsp/periph_spi.c **** 		retry++;
 300              		.loc 1 75 3 is_stmt 1 view .LVU63
 301              		.loc 1 75 8 is_stmt 0 view .LVU64
 302 0016 0134     		adds	r4, r4, #1
 303              	.LVL24:
 304              		.loc 1 75 8 view .LVU65
 305 0018 A4B2     		uxth	r4, r4
 306              	.LVL25:
  76:Bsp/periph_spi.c **** 		if (retry > SPI_TIMEOUT)
 307              		.loc 1 76 3 is_stmt 1 view .LVU66
 308              		.loc 1 76 6 is_stmt 0 view .LVU67
 309 001a B4F57A7F 		cmp	r4, #1000
 310 001e F3D9     		bls	.L16
  77:Bsp/periph_spi.c **** 			return false;
 311              		.loc 1 77 11 view .LVU68
 312 0020 0020     		movs	r0, #0
 313 0022 06E0     		b	.L17
 314              	.L21:
  78:Bsp/periph_spi.c **** 	}
  79:Bsp/periph_spi.c **** 	SPI_I2S_SendData(SPI_PORT[SPIx], TxData);
 315              		.loc 1 79 2 is_stmt 1 view .LVU69
 316 0024 3946     		mov	r1, r7
 317 0026 034B     		ldr	r3, .L22
 318 0028 53F82500 		ldr	r0, [r3, r5, lsl #2]
 319 002c FFF7FEFF 		bl	SPI_I2S_SendData
 320              	.LVL26:
  80:Bsp/periph_spi.c **** 	return true;
 321              		.loc 1 80 2 view .LVU70
 322              		.loc 1 80 9 is_stmt 0 view .LVU71
 323 0030 0120     		movs	r0, #1
 324              	.L17:
ARM GAS  /tmp/ccy6Moss.s 			page 8


  81:Bsp/periph_spi.c **** }
 325              		.loc 1 81 1 view .LVU72
 326 0032 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 327              	.LVL27:
 328              	.L23:
 329              		.loc 1 81 1 view .LVU73
 330              		.align	2
 331              	.L22:
 332 0034 00000000 		.word	.LANCHOR0
 333              		.cfi_endproc
 334              	.LFE126:
 336              		.section	.text.periph_SPI_ReadByte,"ax",%progbits
 337              		.align	1
 338              		.global	periph_SPI_ReadByte
 339              		.syntax unified
 340              		.thumb
 341              		.thumb_func
 342              		.fpu fpv4-sp-d16
 344              	periph_SPI_ReadByte:
 345              	.LVL28:
 346              	.LFB127:
  82:Bsp/periph_spi.c **** 
  83:Bsp/periph_spi.c **** bool periph_SPI_ReadByte(SPI_List SPIx, uint8_t *data)
  84:Bsp/periph_spi.c **** {
 347              		.loc 1 84 1 is_stmt 1 view -0
 348              		.cfi_startproc
 349              		@ args = 0, pretend = 0, frame = 0
 350              		@ frame_needed = 0, uses_anonymous_args = 0
 351              		.loc 1 84 1 is_stmt 0 view .LVU75
 352 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 353              	.LCFI7:
 354              		.cfi_def_cfa_offset 24
 355              		.cfi_offset 3, -24
 356              		.cfi_offset 4, -20
 357              		.cfi_offset 5, -16
 358              		.cfi_offset 6, -12
 359              		.cfi_offset 7, -8
 360              		.cfi_offset 14, -4
 361 0002 0546     		mov	r5, r0
 362 0004 0F46     		mov	r7, r1
  85:Bsp/periph_spi.c **** 	uint16_t retry = 0;
 363              		.loc 1 85 2 is_stmt 1 view .LVU76
 364              	.LVL29:
  86:Bsp/periph_spi.c **** 	while (SPI_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_TXE) == RESET)
 365              		.loc 1 86 2 view .LVU77
  85:Bsp/periph_spi.c **** 	uint16_t retry = 0;
 366              		.loc 1 85 11 is_stmt 0 view .LVU78
 367 0006 0024     		movs	r4, #0
 368              	.LVL30:
 369              	.L25:
 370              		.loc 1 86 9 view .LVU79
 371 0008 2E46     		mov	r6, r5
 372 000a 0221     		movs	r1, #2
 373 000c 144B     		ldr	r3, .L35
 374 000e 53F82500 		ldr	r0, [r3, r5, lsl #2]
 375 0012 FFF7FEFF 		bl	SPI_I2S_GetFlagStatus
 376              	.LVL31:
ARM GAS  /tmp/ccy6Moss.s 			page 9


 377              		.loc 1 86 8 view .LVU80
 378 0016 30B9     		cbnz	r0, .L33
  87:Bsp/periph_spi.c **** 	{
  88:Bsp/periph_spi.c **** 		retry++;
 379              		.loc 1 88 3 is_stmt 1 view .LVU81
 380              		.loc 1 88 8 is_stmt 0 view .LVU82
 381 0018 0134     		adds	r4, r4, #1
 382              	.LVL32:
 383              		.loc 1 88 8 view .LVU83
 384 001a A4B2     		uxth	r4, r4
 385              	.LVL33:
  89:Bsp/periph_spi.c **** 		if (retry > SPI_TIMEOUT)
 386              		.loc 1 89 3 is_stmt 1 view .LVU84
 387              		.loc 1 89 6 is_stmt 0 view .LVU85
 388 001c B4F57A7F 		cmp	r4, #1000
 389 0020 F2D9     		bls	.L25
  90:Bsp/periph_spi.c **** 			return false;
 390              		.loc 1 90 11 view .LVU86
 391 0022 0020     		movs	r0, #0
 392 0024 1BE0     		b	.L26
 393              	.L33:
  91:Bsp/periph_spi.c **** 	}
  92:Bsp/periph_spi.c **** 	SPI_I2S_SendData(SPI_PORT[SPIx], 0XFF);
 394              		.loc 1 92 2 is_stmt 1 view .LVU87
 395 0026 FF21     		movs	r1, #255
 396 0028 0D4B     		ldr	r3, .L35
 397 002a 53F82500 		ldr	r0, [r3, r5, lsl #2]
 398 002e FFF7FEFF 		bl	SPI_I2S_SendData
 399              	.LVL34:
  93:Bsp/periph_spi.c **** 
  94:Bsp/periph_spi.c **** 	retry = 0;
 400              		.loc 1 94 2 view .LVU88
  95:Bsp/periph_spi.c **** 	while (SPI_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_RXNE) == RESET)
 401              		.loc 1 95 2 view .LVU89
  94:Bsp/periph_spi.c **** 	while (SPI_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_RXNE) == RESET)
 402              		.loc 1 94 8 is_stmt 0 view .LVU90
 403 0032 0024     		movs	r4, #0
 404              	.LVL35:
 405              	.L28:
 406              		.loc 1 95 9 view .LVU91
 407 0034 0121     		movs	r1, #1
 408 0036 0A4B     		ldr	r3, .L35
 409 0038 53F82600 		ldr	r0, [r3, r6, lsl #2]
 410 003c FFF7FEFF 		bl	SPI_I2S_GetFlagStatus
 411              	.LVL36:
 412              		.loc 1 95 8 view .LVU92
 413 0040 30B9     		cbnz	r0, .L34
  96:Bsp/periph_spi.c **** 	{
  97:Bsp/periph_spi.c **** 		retry++;
 414              		.loc 1 97 3 is_stmt 1 view .LVU93
 415              		.loc 1 97 8 is_stmt 0 view .LVU94
 416 0042 0134     		adds	r4, r4, #1
 417              	.LVL37:
 418              		.loc 1 97 8 view .LVU95
 419 0044 A4B2     		uxth	r4, r4
 420              	.LVL38:
  98:Bsp/periph_spi.c **** 		if (retry > SPI_TIMEOUT)
ARM GAS  /tmp/ccy6Moss.s 			page 10


 421              		.loc 1 98 3 is_stmt 1 view .LVU96
 422              		.loc 1 98 6 is_stmt 0 view .LVU97
 423 0046 B4F57A7F 		cmp	r4, #1000
 424 004a F3D9     		bls	.L28
  99:Bsp/periph_spi.c **** 			return false;
 425              		.loc 1 99 11 view .LVU98
 426 004c 0020     		movs	r0, #0
 427 004e 06E0     		b	.L26
 428              	.L34:
 100:Bsp/periph_spi.c **** 	}
 101:Bsp/periph_spi.c **** 	*data = SPI_I2S_ReceiveData(SPI_PORT[SPIx]);
 429              		.loc 1 101 2 is_stmt 1 view .LVU99
 430              		.loc 1 101 10 is_stmt 0 view .LVU100
 431 0050 034B     		ldr	r3, .L35
 432 0052 53F82600 		ldr	r0, [r3, r6, lsl #2]
 433 0056 FFF7FEFF 		bl	SPI_I2S_ReceiveData
 434              	.LVL39:
 435              		.loc 1 101 8 view .LVU101
 436 005a 3870     		strb	r0, [r7]
 102:Bsp/periph_spi.c **** 	return true;
 437              		.loc 1 102 2 is_stmt 1 view .LVU102
 438              		.loc 1 102 9 is_stmt 0 view .LVU103
 439 005c 0120     		movs	r0, #1
 440              	.L26:
 103:Bsp/periph_spi.c **** }
 441              		.loc 1 103 1 view .LVU104
 442 005e F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 443              	.LVL40:
 444              	.L36:
 445              		.loc 1 103 1 view .LVU105
 446              		.align	2
 447              	.L35:
 448 0060 00000000 		.word	.LANCHOR0
 449              		.cfi_endproc
 450              	.LFE127:
 452              		.section	.text.periph_SPI_ReadWriteByte,"ax",%progbits
 453              		.align	1
 454              		.global	periph_SPI_ReadWriteByte
 455              		.syntax unified
 456              		.thumb
 457              		.thumb_func
 458              		.fpu fpv4-sp-d16
 460              	periph_SPI_ReadWriteByte:
 461              	.LVL41:
 462              	.LFB128:
 104:Bsp/periph_spi.c **** 
 105:Bsp/periph_spi.c **** bool periph_SPI_ReadWriteByte(SPI_List SPIx, uint8_t TxData, uint8_t *RxData)
 106:Bsp/periph_spi.c **** {
 463              		.loc 1 106 1 is_stmt 1 view -0
 464              		.cfi_startproc
 465              		@ args = 0, pretend = 0, frame = 0
 466              		@ frame_needed = 0, uses_anonymous_args = 0
 467              		.loc 1 106 1 is_stmt 0 view .LVU107
 468 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 469              	.LCFI8:
 470              		.cfi_def_cfa_offset 24
 471              		.cfi_offset 4, -24
ARM GAS  /tmp/ccy6Moss.s 			page 11


 472              		.cfi_offset 5, -20
 473              		.cfi_offset 6, -16
 474              		.cfi_offset 7, -12
 475              		.cfi_offset 8, -8
 476              		.cfi_offset 14, -4
 477 0004 0546     		mov	r5, r0
 478 0006 8846     		mov	r8, r1
 479 0008 1746     		mov	r7, r2
 107:Bsp/periph_spi.c **** 	uint16_t retry = 0;
 480              		.loc 1 107 2 is_stmt 1 view .LVU108
 481              	.LVL42:
 108:Bsp/periph_spi.c **** 	while (SPI_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_TXE) == RESET)
 482              		.loc 1 108 2 view .LVU109
 107:Bsp/periph_spi.c **** 	uint16_t retry = 0;
 483              		.loc 1 107 11 is_stmt 0 view .LVU110
 484 000a 0024     		movs	r4, #0
 485              	.LVL43:
 486              	.L38:
 487              		.loc 1 108 9 view .LVU111
 488 000c 2E46     		mov	r6, r5
 489 000e 0221     		movs	r1, #2
 490 0010 154B     		ldr	r3, .L48
 491 0012 53F82500 		ldr	r0, [r3, r5, lsl #2]
 492 0016 FFF7FEFF 		bl	SPI_I2S_GetFlagStatus
 493              	.LVL44:
 494              		.loc 1 108 8 view .LVU112
 495 001a 30B9     		cbnz	r0, .L46
 109:Bsp/periph_spi.c **** 	{
 110:Bsp/periph_spi.c **** 		retry++;
 496              		.loc 1 110 3 is_stmt 1 view .LVU113
 497              		.loc 1 110 8 is_stmt 0 view .LVU114
 498 001c 0134     		adds	r4, r4, #1
 499              	.LVL45:
 500              		.loc 1 110 8 view .LVU115
 501 001e A4B2     		uxth	r4, r4
 502              	.LVL46:
 111:Bsp/periph_spi.c **** 		if (retry > SPI_TIMEOUT)
 503              		.loc 1 111 3 is_stmt 1 view .LVU116
 504              		.loc 1 111 6 is_stmt 0 view .LVU117
 505 0020 B4F57A7F 		cmp	r4, #1000
 506 0024 F2D9     		bls	.L38
 112:Bsp/periph_spi.c **** 			return false;
 507              		.loc 1 112 11 view .LVU118
 508 0026 0020     		movs	r0, #0
 509 0028 1BE0     		b	.L39
 510              	.L46:
 113:Bsp/periph_spi.c **** 	}
 114:Bsp/periph_spi.c **** 	SPI_I2S_SendData(SPI_PORT[SPIx], TxData);
 511              		.loc 1 114 2 is_stmt 1 view .LVU119
 512 002a 4146     		mov	r1, r8
 513 002c 0E4B     		ldr	r3, .L48
 514 002e 53F82500 		ldr	r0, [r3, r5, lsl #2]
 515 0032 FFF7FEFF 		bl	SPI_I2S_SendData
 516              	.LVL47:
 115:Bsp/periph_spi.c **** 
 116:Bsp/periph_spi.c **** 	retry = 0;
 517              		.loc 1 116 2 view .LVU120
ARM GAS  /tmp/ccy6Moss.s 			page 12


 117:Bsp/periph_spi.c **** 	while (SPI_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_RXNE) == RESET)
 518              		.loc 1 117 2 view .LVU121
 116:Bsp/periph_spi.c **** 	while (SPI_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_RXNE) == RESET)
 519              		.loc 1 116 8 is_stmt 0 view .LVU122
 520 0036 0024     		movs	r4, #0
 521              	.LVL48:
 522              	.L41:
 523              		.loc 1 117 9 view .LVU123
 524 0038 0121     		movs	r1, #1
 525 003a 0B4B     		ldr	r3, .L48
 526 003c 53F82600 		ldr	r0, [r3, r6, lsl #2]
 527 0040 FFF7FEFF 		bl	SPI_I2S_GetFlagStatus
 528              	.LVL49:
 529              		.loc 1 117 8 view .LVU124
 530 0044 30B9     		cbnz	r0, .L47
 118:Bsp/periph_spi.c **** 	{
 119:Bsp/periph_spi.c **** 		retry++;
 531              		.loc 1 119 3 is_stmt 1 view .LVU125
 532              		.loc 1 119 8 is_stmt 0 view .LVU126
 533 0046 0134     		adds	r4, r4, #1
 534              	.LVL50:
 535              		.loc 1 119 8 view .LVU127
 536 0048 A4B2     		uxth	r4, r4
 537              	.LVL51:
 120:Bsp/periph_spi.c **** 		if (retry > SPI_TIMEOUT)
 538              		.loc 1 120 3 is_stmt 1 view .LVU128
 539              		.loc 1 120 6 is_stmt 0 view .LVU129
 540 004a B4F57A7F 		cmp	r4, #1000
 541 004e F3D9     		bls	.L41
 121:Bsp/periph_spi.c **** 			return false;
 542              		.loc 1 121 11 view .LVU130
 543 0050 0020     		movs	r0, #0
 544 0052 06E0     		b	.L39
 545              	.L47:
 122:Bsp/periph_spi.c **** 	}
 123:Bsp/periph_spi.c **** 
 124:Bsp/periph_spi.c **** 	*RxData = SPI_I2S_ReceiveData(SPI_PORT[SPIx]);
 546              		.loc 1 124 2 is_stmt 1 view .LVU131
 547              		.loc 1 124 12 is_stmt 0 view .LVU132
 548 0054 044B     		ldr	r3, .L48
 549 0056 53F82600 		ldr	r0, [r3, r6, lsl #2]
 550 005a FFF7FEFF 		bl	SPI_I2S_ReceiveData
 551              	.LVL52:
 552              		.loc 1 124 10 view .LVU133
 553 005e 3870     		strb	r0, [r7]
 125:Bsp/periph_spi.c **** 
 126:Bsp/periph_spi.c **** 	return true;
 554              		.loc 1 126 2 is_stmt 1 view .LVU134
 555              		.loc 1 126 9 is_stmt 0 view .LVU135
 556 0060 0120     		movs	r0, #1
 557              	.L39:
 127:Bsp/periph_spi.c **** }
 558              		.loc 1 127 1 view .LVU136
 559 0062 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 560              	.LVL53:
 561              	.L49:
 562              		.loc 1 127 1 view .LVU137
ARM GAS  /tmp/ccy6Moss.s 			page 13


 563 0066 00BF     		.align	2
 564              	.L48:
 565 0068 00000000 		.word	.LANCHOR0
 566              		.cfi_endproc
 567              	.LFE128:
 569              		.section	.text.periph_SPI_Transfer,"ax",%progbits
 570              		.align	1
 571              		.global	periph_SPI_Transfer
 572              		.syntax unified
 573              		.thumb
 574              		.thumb_func
 575              		.fpu fpv4-sp-d16
 577              	periph_SPI_Transfer:
 578              	.LVL54:
 579              	.LFB129:
 128:Bsp/periph_spi.c **** 
 129:Bsp/periph_spi.c **** uint16_t periph_SPI_Transfer(SPI_List SPIx, uint8_t *rx, uint8_t *tx, uint16_t len)
 130:Bsp/periph_spi.c **** {
 580              		.loc 1 130 1 is_stmt 1 view -0
 581              		.cfi_startproc
 582              		@ args = 0, pretend = 0, frame = 0
 583              		@ frame_needed = 0, uses_anonymous_args = 0
 584              		.loc 1 130 1 is_stmt 0 view .LVU139
 585 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 586              	.LCFI9:
 587              		.cfi_def_cfa_offset 32
 588              		.cfi_offset 3, -32
 589              		.cfi_offset 4, -28
 590              		.cfi_offset 5, -24
 591              		.cfi_offset 6, -20
 592              		.cfi_offset 7, -16
 593              		.cfi_offset 8, -12
 594              		.cfi_offset 9, -8
 595              		.cfi_offset 14, -4
 596 0004 8846     		mov	r8, r1
 597 0006 1646     		mov	r6, r2
 131:Bsp/periph_spi.c **** 	uint16_t spitimeout = SPI_TIMEOUT;
 598              		.loc 1 131 2 is_stmt 1 view .LVU140
 599              	.LVL55:
 132:Bsp/periph_spi.c **** 	uint8_t b;
 600              		.loc 1 132 2 view .LVU141
 133:Bsp/periph_spi.c **** 	SPI_PORT[SPIx]->DR;
 601              		.loc 1 133 2 view .LVU142
 602              		.loc 1 133 10 is_stmt 0 view .LVU143
 603 0008 0546     		mov	r5, r0
 604 000a 204A     		ldr	r2, .L65
 605              	.LVL56:
 606              		.loc 1 133 10 view .LVU144
 607 000c 52F82020 		ldr	r2, [r2, r0, lsl #2]
 608              		.loc 1 133 16 view .LVU145
 609 0010 9289     		ldrh	r2, [r2, #12]
 134:Bsp/periph_spi.c **** 	while (len--)
 610              		.loc 1 134 2 is_stmt 1 view .LVU146
 131:Bsp/periph_spi.c **** 	uint8_t b;
 611              		.loc 1 131 11 is_stmt 0 view .LVU147
 612 0012 4FF47A74 		mov	r4, #1000
 613              	.LVL57:
ARM GAS  /tmp/ccy6Moss.s 			page 14


 614              	.L51:
 615              		.loc 1 134 12 view .LVU148
 616 0016 5F1E     		subs	r7, r3, #1
 617 0018 BFB2     		uxth	r7, r7
 618              	.LVL58:
 619              		.loc 1 134 8 view .LVU149
 620 001a 93B3     		cbz	r3, .L62
 135:Bsp/periph_spi.c **** 	{
 136:Bsp/periph_spi.c **** 		b = tx ? *(tx++) : 0xff;
 621              		.loc 1 136 3 is_stmt 1 view .LVU150
 622              		.loc 1 136 5 is_stmt 0 view .LVU151
 623 001c 6EB1     		cbz	r6, .L60
 624              		.loc 1 136 5 discriminator 1 view .LVU152
 625 001e 16F8019B 		ldrb	r9, [r6], #1	@ zero_extendqisi2
 626              	.LVL59:
 627              	.L53:
 137:Bsp/periph_spi.c **** 
 138:Bsp/periph_spi.c **** 		while (SPI_I2S_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_TXE) == RESET)
 628              		.loc 1 138 10 view .LVU153
 629 0022 0221     		movs	r1, #2
 630 0024 194B     		ldr	r3, .L65
 631 0026 53F82500 		ldr	r0, [r3, r5, lsl #2]
 632 002a FFF7FEFF 		bl	SPI_I2S_GetFlagStatus
 633              	.LVL60:
 634              		.loc 1 138 9 view .LVU154
 635 002e 38B9     		cbnz	r0, .L63
 139:Bsp/periph_spi.c **** 		{
 140:Bsp/periph_spi.c **** 			if ((spitimeout--) == 0)
 636              		.loc 1 140 4 is_stmt 1 view .LVU155
 637              		.loc 1 140 19 is_stmt 0 view .LVU156
 638 0030 631E     		subs	r3, r4, #1
 639 0032 9BB2     		uxth	r3, r3
 640              	.LVL61:
 641              		.loc 1 140 7 view .LVU157
 642 0034 34B3     		cbz	r4, .L54
 643              		.loc 1 140 19 view .LVU158
 644 0036 1C46     		mov	r4, r3
 645 0038 F3E7     		b	.L53
 646              	.LVL62:
 647              	.L60:
 136:Bsp/periph_spi.c **** 
 648              		.loc 1 136 5 view .LVU159
 649 003a 4FF0FF09 		mov	r9, #255
 650              	.LVL63:
 138:Bsp/periph_spi.c **** 		{
 651              		.loc 1 138 3 is_stmt 1 view .LVU160
 138:Bsp/periph_spi.c **** 		{
 652              		.loc 1 138 9 is_stmt 0 view .LVU161
 653 003e F0E7     		b	.L53
 654              	.LVL64:
 655              	.L63:
 141:Bsp/periph_spi.c **** 			{
 142:Bsp/periph_spi.c **** 				return 0;
 143:Bsp/periph_spi.c **** 			}
 144:Bsp/periph_spi.c **** 		}
 145:Bsp/periph_spi.c **** 		SPI_I2S_SendData(SPI_PORT[SPIx], b);
 656              		.loc 1 145 3 is_stmt 1 view .LVU162
ARM GAS  /tmp/ccy6Moss.s 			page 15


 657 0040 4946     		mov	r1, r9
 658 0042 124B     		ldr	r3, .L65
 659 0044 53F82500 		ldr	r0, [r3, r5, lsl #2]
 660 0048 FFF7FEFF 		bl	SPI_I2S_SendData
 661              	.LVL65:
 146:Bsp/periph_spi.c **** 
 147:Bsp/periph_spi.c **** 		spitimeout = SPI_TIMEOUT;
 662              		.loc 1 147 3 view .LVU163
 148:Bsp/periph_spi.c **** 		while (SPI_I2S_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_RXNE) == RESET)
 663              		.loc 1 148 3 view .LVU164
 147:Bsp/periph_spi.c **** 		while (SPI_I2S_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_RXNE) == RESET)
 664              		.loc 1 147 14 is_stmt 0 view .LVU165
 665 004c 4FF47A74 		mov	r4, #1000
 666              	.LVL66:
 667              	.L56:
 668              		.loc 1 148 10 view .LVU166
 669 0050 0121     		movs	r1, #1
 670 0052 0E4B     		ldr	r3, .L65
 671 0054 53F82500 		ldr	r0, [r3, r5, lsl #2]
 672 0058 FFF7FEFF 		bl	SPI_I2S_GetFlagStatus
 673              	.LVL67:
 674              		.loc 1 148 9 view .LVU167
 675 005c 20B9     		cbnz	r0, .L64
 149:Bsp/periph_spi.c **** 		{
 150:Bsp/periph_spi.c **** 			if ((spitimeout--) == 0)
 676              		.loc 1 150 4 is_stmt 1 view .LVU168
 677              		.loc 1 150 19 is_stmt 0 view .LVU169
 678 005e 631E     		subs	r3, r4, #1
 679 0060 9BB2     		uxth	r3, r3
 680              	.LVL68:
 681              		.loc 1 150 7 view .LVU170
 682 0062 7CB1     		cbz	r4, .L54
 683              		.loc 1 150 19 view .LVU171
 684 0064 1C46     		mov	r4, r3
 685 0066 F3E7     		b	.L56
 686              	.LVL69:
 687              	.L64:
 151:Bsp/periph_spi.c **** 			{
 152:Bsp/periph_spi.c **** 				return 0;
 153:Bsp/periph_spi.c **** 			}
 154:Bsp/periph_spi.c **** 		}
 155:Bsp/periph_spi.c **** 
 156:Bsp/periph_spi.c **** 		b = SPI_I2S_ReceiveData(SPI_PORT[SPIx]);
 688              		.loc 1 156 3 is_stmt 1 view .LVU172
 689              		.loc 1 156 7 is_stmt 0 view .LVU173
 690 0068 084B     		ldr	r3, .L65
 691 006a 53F82500 		ldr	r0, [r3, r5, lsl #2]
 692 006e FFF7FEFF 		bl	SPI_I2S_ReceiveData
 693              	.LVL70:
 694              		.loc 1 156 5 view .LVU174
 695 0072 C0B2     		uxtb	r0, r0
 696              	.LVL71:
 157:Bsp/periph_spi.c **** 		if (rx)
 697              		.loc 1 157 3 is_stmt 1 view .LVU175
 698              		.loc 1 157 6 is_stmt 0 view .LVU176
 699 0074 B8F1000F 		cmp	r8, #0
 700 0078 01D0     		beq	.L58
ARM GAS  /tmp/ccy6Moss.s 			page 16


 158:Bsp/periph_spi.c **** 		{
 159:Bsp/periph_spi.c **** 			*(rx++) = b;
 701              		.loc 1 159 4 is_stmt 1 view .LVU177
 702              		.loc 1 159 12 is_stmt 0 view .LVU178
 703 007a 08F8010B 		strb	r0, [r8], #1
 704              	.LVL72:
 705              	.L58:
 706              		.loc 1 159 8 view .LVU179
 707 007e 3B46     		mov	r3, r7
 708 0080 C9E7     		b	.L51
 709              	.LVL73:
 710              	.L62:
 160:Bsp/periph_spi.c **** 		}
 161:Bsp/periph_spi.c **** 	}
 162:Bsp/periph_spi.c **** 	return len;
 711              		.loc 1 162 9 view .LVU180
 712 0082 3C46     		mov	r4, r7
 713              	.LVL74:
 714              	.L54:
 163:Bsp/periph_spi.c **** }
 715              		.loc 1 163 1 view .LVU181
 716 0084 2046     		mov	r0, r4
 717 0086 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 718              	.LVL75:
 719              	.L66:
 720              		.loc 1 163 1 view .LVU182
 721 008a 00BF     		.align	2
 722              	.L65:
 723 008c 00000000 		.word	.LANCHOR0
 724              		.cfi_endproc
 725              	.LFE129:
 727              		.section	.text.periph_SPI_CheckBusy,"ax",%progbits
 728              		.align	1
 729              		.global	periph_SPI_CheckBusy
 730              		.syntax unified
 731              		.thumb
 732              		.thumb_func
 733              		.fpu fpv4-sp-d16
 735              	periph_SPI_CheckBusy:
 736              	.LVL76:
 737              	.LFB130:
 164:Bsp/periph_spi.c **** 
 165:Bsp/periph_spi.c **** uint8_t periph_SPI_CheckBusy(SPI_List SPIx)
 166:Bsp/periph_spi.c **** {
 738              		.loc 1 166 1 is_stmt 1 view -0
 739              		.cfi_startproc
 740              		@ args = 0, pretend = 0, frame = 0
 741              		@ frame_needed = 0, uses_anonymous_args = 0
 742              		.loc 1 166 1 is_stmt 0 view .LVU184
 743 0000 10B5     		push	{r4, lr}
 744              	.LCFI10:
 745              		.cfi_def_cfa_offset 8
 746              		.cfi_offset 4, -8
 747              		.cfi_offset 14, -4
 748 0002 0446     		mov	r4, r0
 167:Bsp/periph_spi.c **** 	return SPI_I2S_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_TXE) == RESET || SPI_I2S_GetFlagStatus(S
 749              		.loc 1 167 2 is_stmt 1 view .LVU185
ARM GAS  /tmp/ccy6Moss.s 			page 17


 750              		.loc 1 167 9 is_stmt 0 view .LVU186
 751 0004 0221     		movs	r1, #2
 752 0006 0A4B     		ldr	r3, .L73
 753 0008 53F82000 		ldr	r0, [r3, r0, lsl #2]
 754              	.LVL77:
 755              		.loc 1 167 9 view .LVU187
 756 000c FFF7FEFF 		bl	SPI_I2S_GetFlagStatus
 757              	.LVL78:
 758              		.loc 1 167 74 view .LVU188
 759 0010 08B9     		cbnz	r0, .L72
 760 0012 0120     		movs	r0, #1
 761              	.L68:
 168:Bsp/periph_spi.c **** }
 762              		.loc 1 168 1 discriminator 6 view .LVU189
 763 0014 10BD     		pop	{r4, pc}
 764              	.L72:
 167:Bsp/periph_spi.c **** 	return SPI_I2S_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_TXE) == RESET || SPI_I2S_GetFlagStatus(S
 765              		.loc 1 167 77 discriminator 2 view .LVU190
 766 0016 8021     		movs	r1, #128
 767 0018 054B     		ldr	r3, .L73
 768 001a 53F82400 		ldr	r0, [r3, r4, lsl #2]
 769 001e FFF7FEFF 		bl	SPI_I2S_GetFlagStatus
 770              	.LVL79:
 167:Bsp/periph_spi.c **** 	return SPI_I2S_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_TXE) == RESET || SPI_I2S_GetFlagStatus(S
 771              		.loc 1 167 74 discriminator 2 view .LVU191
 772 0022 0128     		cmp	r0, #1
 773 0024 01D0     		beq	.L70
 167:Bsp/periph_spi.c **** 	return SPI_I2S_GetFlagStatus(SPI_PORT[SPIx], SPI_I2S_FLAG_TXE) == RESET || SPI_I2S_GetFlagStatus(S
 774              		.loc 1 167 74 view .LVU192
 775 0026 0020     		movs	r0, #0
 776 0028 F4E7     		b	.L68
 777              	.L70:
 778 002a 0120     		movs	r0, #1
 779 002c F2E7     		b	.L68
 780              	.L74:
 781 002e 00BF     		.align	2
 782              	.L73:
 783 0030 00000000 		.word	.LANCHOR0
 784              		.cfi_endproc
 785              	.LFE130:
 787              		.global	SpiErrorCount2
 788              		.global	SpiErrorCount
 789              		.section	.bss.SpiErrorCount,"aw",%nobits
 790              		.align	1
 793              	SpiErrorCount:
 794 0000 0000     		.space	2
 795              		.section	.bss.SpiErrorCount2,"aw",%nobits
 796              		.align	1
 799              	SpiErrorCount2:
 800 0000 0000     		.space	2
 801              		.section	.rodata.SPI_CLK,"a"
 802              		.align	2
 803              		.set	.LANCHOR2,. + 0
 806              	SPI_CLK:
 807 0000 00100000 		.word	4096
 808 0004 00400000 		.word	16384
 809 0008 00800000 		.word	32768
ARM GAS  /tmp/ccy6Moss.s 			page 18


 810              		.section	.rodata.SPI_IO_Init,"a"
 811              		.align	2
 812              		.set	.LANCHOR1,. + 0
 815              	SPI_IO_Init:
 816 0000 00000000 		.word	GPIO_SPI1_IO_Init
 817 0004 00000000 		.word	GPIO_SPI2_IO_Init
 818 0008 00000000 		.word	GPIO_SPI3_IO_Init
 819              		.section	.rodata.SPI_PORT,"a"
 820              		.align	2
 821              		.set	.LANCHOR0,. + 0
 824              	SPI_PORT:
 825 0000 00300140 		.word	1073819648
 826 0004 00380040 		.word	1073756160
 827 0008 003C0040 		.word	1073757184
 828              		.section	.rodata.divisorMap,"a"
 829              		.align	2
 830              		.set	.LANCHOR3,. + 0
 833              	divisorMap:
 834 0000 3800     		.short	56
 835 0002 3000     		.short	48
 836 0004 1000     		.short	16
 837 0006 0800     		.short	8
 838 0008 0000     		.short	0
 839              		.text
 840              	.Letext0:
 841              		.file 2 "/home/bt0/stm32/compile-tool/gcc-arm-none-eabi-8-2018-q4-major-linux/gcc-arm-none-eabi-8-
 842              		.file 3 "/home/bt0/stm32/compile-tool/gcc-arm-none-eabi-8-2018-q4-major-linux/gcc-arm-none-eabi-8-
 843              		.file 4 "F4_CORE/core_cm4.h"
 844              		.file 5 "USER/system_stm32f4xx.h"
 845              		.file 6 "USER/stm32f4xx.h"
 846              		.file 7 "FWLIB/inc/stm32f4xx_spi.h"
 847              		.file 8 "Bsp/periph_spi.h"
 848              		.file 9 "FWLIB/inc/stm32f4xx_rcc.h"
ARM GAS  /tmp/ccy6Moss.s 			page 19


DEFINED SYMBOLS
                            *ABS*:0000000000000000 periph_spi.c
     /tmp/ccy6Moss.s:18     .text.periph_SPI_DeInit:0000000000000000 $t
     /tmp/ccy6Moss.s:26     .text.periph_SPI_DeInit:0000000000000000 periph_SPI_DeInit
     /tmp/ccy6Moss.s:52     .text.periph_SPI_DeInit:0000000000000010 $d
     /tmp/ccy6Moss.s:57     .text.periph_SPI_Init:0000000000000000 $t
     /tmp/ccy6Moss.s:64     .text.periph_SPI_Init:0000000000000000 periph_SPI_Init
     /tmp/ccy6Moss.s:182    .text.periph_SPI_Init:0000000000000090 $d
     /tmp/ccy6Moss.s:190    .text.periph_SPI_SetSpeed:0000000000000000 $t
     /tmp/ccy6Moss.s:197    .text.periph_SPI_SetSpeed:0000000000000000 periph_SPI_SetSpeed
     /tmp/ccy6Moss.s:253    .text.periph_SPI_SetSpeed:0000000000000030 $d
     /tmp/ccy6Moss.s:259    .text.periph_SPI_WriteByte:0000000000000000 $t
     /tmp/ccy6Moss.s:266    .text.periph_SPI_WriteByte:0000000000000000 periph_SPI_WriteByte
     /tmp/ccy6Moss.s:332    .text.periph_SPI_WriteByte:0000000000000034 $d
     /tmp/ccy6Moss.s:337    .text.periph_SPI_ReadByte:0000000000000000 $t
     /tmp/ccy6Moss.s:344    .text.periph_SPI_ReadByte:0000000000000000 periph_SPI_ReadByte
     /tmp/ccy6Moss.s:448    .text.periph_SPI_ReadByte:0000000000000060 $d
     /tmp/ccy6Moss.s:453    .text.periph_SPI_ReadWriteByte:0000000000000000 $t
     /tmp/ccy6Moss.s:460    .text.periph_SPI_ReadWriteByte:0000000000000000 periph_SPI_ReadWriteByte
     /tmp/ccy6Moss.s:565    .text.periph_SPI_ReadWriteByte:0000000000000068 $d
     /tmp/ccy6Moss.s:570    .text.periph_SPI_Transfer:0000000000000000 $t
     /tmp/ccy6Moss.s:577    .text.periph_SPI_Transfer:0000000000000000 periph_SPI_Transfer
     /tmp/ccy6Moss.s:723    .text.periph_SPI_Transfer:000000000000008c $d
     /tmp/ccy6Moss.s:728    .text.periph_SPI_CheckBusy:0000000000000000 $t
     /tmp/ccy6Moss.s:735    .text.periph_SPI_CheckBusy:0000000000000000 periph_SPI_CheckBusy
     /tmp/ccy6Moss.s:783    .text.periph_SPI_CheckBusy:0000000000000030 $d
     /tmp/ccy6Moss.s:799    .bss.SpiErrorCount2:0000000000000000 SpiErrorCount2
     /tmp/ccy6Moss.s:793    .bss.SpiErrorCount:0000000000000000 SpiErrorCount
     /tmp/ccy6Moss.s:790    .bss.SpiErrorCount:0000000000000000 $d
     /tmp/ccy6Moss.s:796    .bss.SpiErrorCount2:0000000000000000 $d
     /tmp/ccy6Moss.s:802    .rodata.SPI_CLK:0000000000000000 $d
     /tmp/ccy6Moss.s:806    .rodata.SPI_CLK:0000000000000000 SPI_CLK
     /tmp/ccy6Moss.s:811    .rodata.SPI_IO_Init:0000000000000000 $d
     /tmp/ccy6Moss.s:815    .rodata.SPI_IO_Init:0000000000000000 SPI_IO_Init
     /tmp/ccy6Moss.s:820    .rodata.SPI_PORT:0000000000000000 $d
     /tmp/ccy6Moss.s:824    .rodata.SPI_PORT:0000000000000000 SPI_PORT
     /tmp/ccy6Moss.s:829    .rodata.divisorMap:0000000000000000 $d
     /tmp/ccy6Moss.s:833    .rodata.divisorMap:0000000000000000 divisorMap

UNDEFINED SYMBOLS
SPI_I2S_DeInit
RCC_APB2PeriphClockCmd
SPI_Cmd
SPI_Init
RCC_APB1PeriphClockCmd
SPI_I2S_GetFlagStatus
SPI_I2S_SendData
SPI_I2S_ReceiveData
GPIO_SPI1_IO_Init
GPIO_SPI2_IO_Init
GPIO_SPI3_IO_Init
